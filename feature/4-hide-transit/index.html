<!DOCTYPE html>
<html lang="en" data-bs-theme="light">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="Ivan Pepelnjak, ipSpace.net AG">
        <link rel="canonical" href="https://isis.bgplabs.net/feature/4-hide-transit/">
        <link rel="shortcut icon" href="../../img/favicon.ico">
  <title>Hide Transit Subnets in IS-IS Networks &#171; IS-IS Labs</title>
        <link href="../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../css/fontawesome.min.css" rel="stylesheet">
        <link href="../../css/brands.min.css" rel="stylesheet">
        <link href="../../css/solid.min.css" rel="stylesheet">
        <link href="../../css/v4-font-face.min.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link id="hljs-light" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" >
        <link id="hljs-dark" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github-dark.min.css" disabled>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script>hljs.highlightAll();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="../..">IS-IS Labs</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar-collapse" aria-controls="navbar-collapse" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle" role="button" data-bs-toggle="dropdown"  aria-expanded="false">Home</a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../.." class="dropdown-item">Labs Overview</a>
</li>
                                    
<li>
    <a href="../../99-about/" class="dropdown-item">About the Project</a>
</li>
                                </ul>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle" role="button" data-bs-toggle="dropdown"  aria-expanded="false">Installation</a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../1-setup/" class="dropdown-item">Installation and Setup</a>
</li>
                                    
<li>
    <a href="../../4-codespaces/" class="dropdown-item">Use GitHub Codespaces</a>
</li>
                                </ul>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle" role="button" data-bs-toggle="dropdown"  aria-expanded="false">Basics</a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../basic/" class="dropdown-item">Overview</a>
</li>
                                    
<li>
    <a href="../../basic/0-frrouting/" class="dropdown-item">Configuring IS-IS on FRRouting</a>
</li>
                                    
<li>
    <a href="../../basic/1-simple-ipv4/" class="dropdown-item">Configure IS-IS Routing for IPv4</a>
</li>
                                    
<li>
    <a href="../../basic/2-explore/" class="dropdown-item">Explore IS-IS Data Structures</a>
</li>
                                    
<li>
    <a href="../../basic/3-p2p/" class="dropdown-item">IS-IS on Point-to-Point Links</a>
</li>
                                    
<li>
    <a href="../../basic/4-metric/" class="dropdown-item">Using IS-IS Metrics</a>
</li>
                                    
<li>
    <a href="../../basic/5-ipv6/" class="dropdown-item">Dual-Stack (IPv4+IPv6) IS-IS Routing</a>
</li>
                                    
<li>
    <a href="../../basic/6-level-2/" class="dropdown-item">Optimize Simple IS-IS Deployments</a>
</li>
                                    
<li>
    <a href="../../basic/7-unnumbered/" class="dropdown-item">Running IS-IS Over Unnumbered Interfaces</a>
</li>
                                </ul>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle active" aria-current="page" role="button" data-bs-toggle="dropdown"  aria-expanded="false">Features</a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../1-passive/" class="dropdown-item">Passive IS-IS Interfaces</a>
</li>
                                    
<li>
    <a href="../2-dis/" class="dropdown-item">Influence the Designated IS Election</a>
</li>
                                    
<li>
    <a href="../3-md5/" class="dropdown-item">Protect IS-IS Routing Data with MD5 Authentication</a>
</li>
                                    
<li>
    <a href="./" class="dropdown-item active" aria-current="page">Hide Transit Subnets in IS-IS Networks</a>
</li>
                                    
<li>
    <a href="../5-drain/" class="dropdown-item">Drain Traffic Before Node Maintenance</a>
</li>
                                    
<li>
    <a href="../6-timers/" class="dropdown-item">Adjust IS-IS Timers</a>
</li>
                                </ul>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle" role="button" data-bs-toggle="dropdown"  aria-expanded="false">Upcoming</a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../3-upcoming/" class="dropdown-item">Overview</a>
</li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ms-md-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-bs-toggle="modal" data-bs-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="../3-md5/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../5-drain/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>

                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3">
<div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
  <div class="navbar-header">
      <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
          <span class="fa fa-angle-down"></span>
      </button>
  </div>

  
  
  
  
  
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary"  style="margin-bottom: 1em;">
      <ul class="nav flex-column">
          
      <li class="nav-item" data-level="1"><a href="#hide-transit-subnets-in-is-is-networks" class="nav-link">Hide Transit Subnets in IS-IS Networks</a>
        <ul class="nav flex-column">
      <li class="nav-item" data-level="2"><a href="#device-requirements" class="nav-link">Device Requirements</a>
        <ul class="nav flex-column">
        </ul>
      </li>
      <li class="nav-item" data-level="2"><a href="#starting-the-lab" class="nav-link">Starting the Lab</a>
        <ul class="nav flex-column">
        </ul>
      </li>
      <li class="nav-item" data-level="2"><a href="#the-problem" class="nav-link">The Problem</a>
        <ul class="nav flex-column">
        </ul>
      </li>
      <li class="nav-item" data-level="2"><a href="#configuration-tasks" class="nav-link">Configuration Tasks</a>
        <ul class="nav flex-column">
        </ul>
      </li>
      <li class="nav-item" data-level="2"><a href="#problem-solved-not-yet" class="nav-link">Problem Solved? Not Yet</a>
        <ul class="nav flex-column">
        </ul>
      </li>
      <li class="nav-item" data-level="2"><a href="#validation" class="nav-link">Validation</a>
        <ul class="nav flex-column">
        </ul>
      </li>
      <li class="nav-item" data-level="2"><a href="#reference-information" class="nav-link">Reference Information</a>
        <ul class="nav flex-column">
      <li class="nav-item" data-level="3"><a href="#lab-wiring" class="nav-link">Lab Wiring</a>
        <ul class="nav flex-column">
        </ul>
      </li>
      <li class="nav-item" data-level="3"><a href="#lab-addressing" class="nav-link">Lab Addressing</a>
        <ul class="nav flex-column">
        </ul>
      </li>
        </ul>
      </li>
        </ul>
      </li>
      </ul>
    </div>
  
  
  
  
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="hide-transit-subnets-in-is-is-networks">Hide Transit Subnets in IS-IS Networks</h1>
<p>Transit subnets (the prefixes configured on inter-router or inter-switch links) could represent a large percentage of the IP routing table in highly meshed networks. Those subnets are usually not used<sup id="fnref:LB"><a class="footnote-ref" href="#fn:LB">1</a></sup> and thus represent pure overhead. Removing them from the IS-IS LSPs would reduce the LSP size and improve the forwarding table convergence time<sup id="fnref:FPI"><a class="footnote-ref" href="#fn:FPI">2</a></sup>. That&rsquo;s what you&rsquo;ll do in this lab exercise.</p>
<p><img alt="Lab topology" src="../topology-hide-transit.png" /></p>
<h2 id="device-requirements">Device Requirements</h2>
<ul>
<li>Use any device <a href="https://netlab.tools/platforms/#platform-routing-support">supported by the <em>netlab</em> IS-IS configuration module</a> for the routers in your lab.</li>
<li>You can do automated lab validation when using Arista EOS on your routers.</li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The <code>advertise-passive-only</code> functionality did not work correctly on any FRRouting release I tested<sup id="fnref:FRI"><a class="footnote-ref" href="#fn:FRI">3</a></sup>. After configuring that IS-IS router configuration command, all IS-IS routes disappeared from the IP routing table.</p>
</div>
<h2 id="starting-the-lab">Starting the Lab</h2>
<p>You can start the lab <a href="../../1-setup/">on your own lab infrastructure</a> or in <a href="https://github.com/codespaces/new/bgplab/isis">GitHub Codespaces</a> (<a href="https://bgplabs.net/4-codespaces/">more details</a>):</p>
<ul>
<li>Change directory to <code>feature/4-hide-transit</code></li>
<li>Execute <strong>netlab up</strong>. You&rsquo;ll get a lab with IPv4 addresses configured on all interfaces and level-2 IS-IS routing configured on all routers.</li>
<li>Log into lab routers with <strong>netlab connect</strong> and verify their configuration.</li>
</ul>
<h2 id="the-problem">The Problem</h2>
<p>Most routers in your network are advertising the /30 prefixes configured on inter-router links. The IP routing table on the WAN router contains three IS-IS loopback prefixes (one for each router), one LAN prefix, and two transit prefixes (the third transit prefix is a connected route).</p>
<p class="code-caption">The IP routing table on the WAN router running Arista EOS<br /></p>
<pre><code>$ netlab connect wan --show ip route isis
Connecting to clab-adv_passive-wan using SSH port 22, executing show ip route isis
...
 I L2     10.0.0.1/32 [115/20]
           via 10.1.0.9, Ethernet1
 I L2     10.0.0.2/32 [115/30]
           via 10.1.0.9, Ethernet1
 I L2     10.0.0.3/32 [115/30]
           via 10.1.0.9, Ethernet1
 I L2     10.1.0.0/30 [115/20]
           via 10.1.0.9, Ethernet1
 I L2     10.1.0.4/30 [115/20]
           via 10.1.0.9, Ethernet1
 I L2     172.16.0.0/24 [115/30]
           via 10.1.0.9, Ethernet1
</code></pre>
<p>You can see the same information in the IS-IS LSPs. For example, the ACC1 router advertises its loopback, LAN, and transit prefixes:</p>
<p class="code-caption">The IS-IS LSP advertised by ACC1<br /></p>
<pre><code>$ netlab connect -q wan --show isis database acc1.00-00 detail
Legend:
H - hostname conflict
U - node unreachable

IS-IS Instance: Gandalf VRF: default
  IS-IS Level 2 Link State Database
    LSPID                   Seq Num  Cksum  Life Length IS  Received LSPID        Flags
    acc1.00-00                    3  13191  1073    119 L2  0000.0000.0002.00-00  &lt;&gt;
      Remaining lifetime received: 1199 s Modified to: 1200 s
      NLPID: 0xCC(IPv4)
      Hostname: acc1
      Area addresses: 49.0001
      Interface address: 10.1.0.1
      Interface address: 172.16.0.1
      Interface address: 10.0.0.2
      IS Neighbor          : acc2.00             Metric: 10
      IS Neighbor          : core.00             Metric: 10
      Reachability         : 10.1.0.0/30 Metric: 10 Type: 1 Up
      Reachability         : 172.16.0.0/24 Metric: 10 Type: 1 Up
      Reachability         : 10.0.0.2/32 Metric: 10 Type: 1 Up
      Router Capabilities: Router Id: 10.0.0.2 Flags: []
        Area leader priority: 250 algorithm: 0
</code></pre>
<h2 id="configuration-tasks">Configuration Tasks</h2>
<p>Many IS-IS implementations contain one or two nerd knobs that can be used to suppress the advertising of transit prefixes. For example, you can control which IP prefixes and which interface addresses the Arista EOS devices advertise.</p>
<ul>
<li>Disable the advertising of transit prefixes on all routers in your lab.</li>
<li>If available, turn off the advertising of transit interface addresses.</li>
</ul>
<p>Some devices also have the opposite nerd knob that can explicitly suppress the subnet used on the interface.</p>
<h2 id="problem-solved-not-yet">Problem Solved? Not Yet</h2>
<p>Connect to the WAN router and inspect the IS-IS routes in its IP routing table. You&rsquo;re done if you see the three loopback prefixes <em>and the LAN prefix</em>. However, if you mindlessly followed the above instructions, you&rsquo;ll get only the three loopback prefixes:</p>
<p class="code-caption">The reduced IP routing table on WAN<br /></p>
<pre><code>$ netlab connect -q wan --show ip route isis
...
 I L2     10.0.0.1/32 [115/20]
           via 10.1.0.9, Ethernet1
 I L2     10.0.0.2/32 [115/30]
           via 10.1.0.9, Ethernet1
 I L2     10.0.0.3/32 [115/30]
           via 10.1.0.9, Ethernet1
</code></pre>
<p>Arista EOS allows you to <em>advertise only the prefixes of the passive interfaces</em>, but the LAN segment connected to ACC1 and ACC2 is not (yet) configured as a passive interface.</p>
<ul>
<li>Configure the LAN segment as a passive interface on ACC1 and ACC2. The details are in the <a href="../1-passive/">Passive IS-IS Interfaces</a> lab exercise.</li>
</ul>
<h2 id="validation">Validation</h2>
<p>You can use the <strong>netlab validate</strong> command if you&rsquo;re using <em>netlab</em> release 1.8.4 or later and run Arista EOS on the WAN router. This is the printout you should get after completing the lab exercise:</p>
<p><img alt="" src="../validate-hide-transit.png" /></p>
<p>You could also manually validate your work. Inspect IS-IS routes in the WAN router&rsquo;s IP routing table; it should contain three loopback (/32) prefixes and a single LAN (/24) prefix but no transit (/30) prefixes.</p>
<p><strong>Next:</strong> <a href="../5-drain/">Drain Traffic Before Node Maintenance</a></p>
<h2 id="reference-information">Reference Information</h2>
<h3 id="lab-wiring">Lab Wiring</h3>
<table>
<thead>
<tr>
<th>Origin Device</th>
<th>Origin Port</th>
<th>Destination Device</th>
<th>Destination Port</th>
</tr>
</thead>
<tbody>
<tr>
<td>core</td>
<td>Ethernet1</td>
<td>acc1</td>
<td>Ethernet1</td>
</tr>
<tr>
<td>core</td>
<td>Ethernet2</td>
<td>acc2</td>
<td>Ethernet1</td>
</tr>
<tr>
<td>core</td>
<td>Ethernet3</td>
<td>wan</td>
<td>Ethernet1</td>
</tr>
<tr>
<td>acc1</td>
<td>Ethernet2</td>
<td>acc2</td>
<td>Ethernet2</td>
</tr>
</tbody>
</table>
<p><strong>Note:</strong> The interface names depend on the devices you use in the lab. The printout was generated with lab devices running Arista EOS.</p>
<h3 id="lab-addressing">Lab Addressing</h3>
<table>
<thead>
<tr>
<th>Node/Interface</th>
<th style="text-align: right;">IPv4 Address</th>
<th style="text-align: right;">IPv6 Address</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>acc1</strong></td>
<td style="text-align: right;">10.0.0.2/32</td>
<td style="text-align: right;"></td>
<td>Loopback</td>
</tr>
<tr>
<td>Ethernet1</td>
<td style="text-align: right;">10.1.0.1/30</td>
<td style="text-align: right;"></td>
<td>acc1 -&gt; core</td>
</tr>
<tr>
<td>Ethernet2</td>
<td style="text-align: right;">172.16.0.1/24</td>
<td style="text-align: right;"></td>
<td>acc1 -&gt; acc2</td>
</tr>
<tr>
<td><strong>acc2</strong></td>
<td style="text-align: right;">10.0.0.3/32</td>
<td style="text-align: right;"></td>
<td>Loopback</td>
</tr>
<tr>
<td>Ethernet1</td>
<td style="text-align: right;">10.1.0.5/30</td>
<td style="text-align: right;"></td>
<td>acc2 -&gt; core</td>
</tr>
<tr>
<td>Ethernet2</td>
<td style="text-align: right;">172.16.0.2/24</td>
<td style="text-align: right;"></td>
<td>acc2 -&gt; acc1</td>
</tr>
<tr>
<td><strong>core</strong></td>
<td style="text-align: right;">10.0.0.1/32</td>
<td style="text-align: right;"></td>
<td>Loopback</td>
</tr>
<tr>
<td>Ethernet1</td>
<td style="text-align: right;">10.1.0.2/30</td>
<td style="text-align: right;"></td>
<td>core -&gt; acc1</td>
</tr>
<tr>
<td>Ethernet2</td>
<td style="text-align: right;">10.1.0.6/30</td>
<td style="text-align: right;"></td>
<td>core -&gt; acc2</td>
</tr>
<tr>
<td>Ethernet3</td>
<td style="text-align: right;">10.1.0.9/30</td>
<td style="text-align: right;"></td>
<td>core -&gt; wan</td>
</tr>
<tr>
<td><strong>wan</strong></td>
<td style="text-align: right;">10.0.0.4/32</td>
<td style="text-align: right;"></td>
<td>Loopback</td>
</tr>
<tr>
<td>Ethernet1</td>
<td style="text-align: right;">10.1.0.10/30</td>
<td style="text-align: right;"></td>
<td>wan -&gt; core</td>
</tr>
</tbody>
</table>
<div class="footnote">
<hr />
<ol>
<li id="fn:LB">
<p>If the IGP is running, you can access a device through its loopback interfaces, and if the IGP is broken, you won&rsquo;t get any reachability information anyway.&#160;<a class="footnote-backref" href="#fnref:LB" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
<li id="fn:FPI">
<p>The forwarding table convergence time on modern devices is usually limited by the bandwidth between the CPU and the switching ASICs. Reducing the size of the IP routing table directly impacts the time it takes to update the forwarding table.&#160;<a class="footnote-backref" href="#fnref:FPI" title="Jump back to footnote 2 in the text">&#8617;</a></p>
</li>
<li id="fn:FRI">
<p>The <a href="https://github.com/FRRouting/frr/issues/16325">issue reporting this bug</a> was closed after nobody touched it for over 6 months.&#160;<a class="footnote-backref" href="#fnref:FRI" title="Jump back to footnote 3 in the text">&#8617;</a></p>
</li>
</ol>
</div></div>
            </div>
        </div>

        <footer class="col-md-12">
<hr>
    <p>(C) 2023â€“2025 Ivan Pepelnjak (ipSpace.net AG)</p>
        </footer>
        <script src="../../js/bootstrap.bundle.min.js"></script>
        <script>
            var base_url = "../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../js/base.js"></script>
        <script src="../../search/main.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
